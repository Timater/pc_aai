# Руководство по использованию системы управления ПК

Этот документ содержит информацию о том, как использовать систему управления ПК и примеры команд для различных задач.

## Запуск системы

### Стандартный запуск

```bash
# Из корневой директории проекта
python src/main.py
```

### Запуск с указанием модели

```bash
python src/main.py --model models/your_model.onnx
```

### Запуск тестов

```bash
python src/main.py --mode test
```

## Интерфейс командной строки

После запуска вы увидите приглашение для ввода команд:

```
Запуск консольного интерфейса ПК-агента.
Для выхода введите 'выход' или 'exit'.

Введите команду:
```

## Поддерживаемые команды

### Навигация по интерфейсу

| Команда | Описание | Пример |
|---------|----------|--------|
| `нажми на [элемент]` | Выполняет клик по указанному элементу | `нажми на кнопку` |
| `кликни [x] [y]` | Выполняет клик по указанным координатам | `кликни 500 300` |
| `правый клик на [элемент]` | Выполняет правый клик мыши | `правый клик на иконку` |
| `двойной клик на [элемент]` | Выполняет двойной клик мыши | `двойной клик на файл` |
| `перетащи [элемент] на [цель]` | Перетаскивает объект | `перетащи файл на рабочий стол` |
| `прокрути вниз` | Прокручивает страницу вниз | `прокрути вниз` |
| `прокрути вверх` | Прокручивает страницу вверх | `прокрути вверх` |
| `прокрути на [число] строк` | Прокручивает на указанное количество строк | `прокрути на 5 строк вниз` |

### Ввод текста

| Команда | Описание | Пример |
|---------|----------|--------|
| `напиши [текст]` | Вводит указанный текст | `напиши Привет, мир!` |
| `введи [текст]` | Вводит указанный текст | `введи user@example.com` |
| `нажми клавишу [клавиша]` | Нажимает указанную клавишу | `нажми клавишу Enter` |
| `комбинация [клавиши]` | Нажимает комбинацию клавиш | `комбинация Ctrl+C` |

### Работа с файлами

| Команда | Описание | Пример |
|---------|----------|--------|
| `открой файл [имя файла]` | Открывает указанный файл | `открой файл document.txt` |
| `найди файл [имя файла]` | Ищет файл в системе | `найди файл report.pdf` |
| `создай файл [имя файла]` | Создает новый файл | `создай файл test.txt` |
| `удали файл [имя файла]` | Удаляет указанный файл | `удали файл temp.txt` |
| `создай папку [имя папки]` | Создает новую папку | `создай папку Projects` |
| `удали папку [имя папки]` | Удаляет указанную папку | `удали папку Temp` |

### Работа с приложениями

| Команда | Описание | Пример |
|---------|----------|--------|
| `запусти [приложение]` | Запускает указанное приложение | `запусти браузер` |
| `открой [приложение]` | Открывает указанное приложение | `открой калькулятор` |
| `закрой [приложение]` | Закрывает указанное приложение | `закрой браузер` |
| `закрой текущее окно` | Закрывает активное окно | `закрой текущее окно` |

## Примеры использования

### Поиск и открытие файла

```
Введите команду: найди файл отчет.docx
✅ Файл найден: C:\Users\User\Documents\отчет.docx

Введите команду: открой файл отчет.docx
✅ Файл отчет.docx открыт
```

### Заполнение веб-формы

```
Введите команду: нажми на поле email
✅ Клик выполнен по элементу text_field

Введите команду: напиши user@example.com
✅ Текст 'user@example.com' введен

Введите команду: нажми на кнопку отправить
✅ Клик выполнен по элементу button
```

### Работа с файловой системой

```
Введите команду: создай папку Проекты
✅ Папка Проекты создана на рабочем столе

Введите команду: создай файл заметки.txt
✅ Файл заметки.txt создан на рабочем столе
```

## Советы по работе с системой

1. **Будьте конкретны в командах**: чем более точно вы описываете элемент или действие, тем лучше система сможет его распознать.

2. **Используйте скриншоты для диагностики**: если система не распознает элемент, проверьте, правильно ли работает модель детекции.

3. **Проверяйте расположение элементов**: если клик происходит мимо элемента, возможно координаты определены неверно.

4. **Увеличивайте задержки**: если действия выполняются слишком быстро, увеличьте задержки между ними.

## Расширение функциональности

Вы можете расширить функциональность системы, добавив новые команды в файл `src/nlp_processor.py` и соответствующие обработчики в `src/main.py`.

```python
# Пример добавления новой команды в nlp_processor.py
self.action_keywords.update({
    "скриншот": "screenshot",
    "сделай снимок": "screenshot"
})

# Пример обработчика в main.py
def _handle_screenshot_action(self, elements, target, params):
    screenshot = self.make_screenshot()
    timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
    filename = f"screenshot_{timestamp}.png"
    cv2.imwrite(filename, screenshot)
    return {"status": "success", "message": f"Скриншот сохранен: {filename}"}
``` 